# APOiBAS_Lab2_EDS
### Лабораторная работа №2 по предмету "Архитектура, программное обеспечение и безопасность автоматизированных систем"

### Задание 2. Электронно-цифровая подпись. Работа с почтой.
В общем виде работа с электронно-цифровой подписью (ЭЦП) происходит по следующей схеме:

![image](https://github.com/SarmiAnsim/APOiBAS_Lab2_EDS/assets/73230774/631dcf3f-9d44-4614-aa25-dcb64099108b)

Рис.  3 Общий принцип работы ЭЦП

Механизм ЭЦП базируется на идеях криптосистем с открытым ключом (ассиметричном шифровании). 
В ассиметричном шифровании применяется пара ключей: открытый (Public key) и закрытый, также называемый секретным (Private key). Открытый и закрытый ключи в данном случае позволяют криптографическому алгоритму шифровать и дешифровать сообщение. При этом сообщения, зашифрованные открытым ключом, расшифровать можно только с помощью закрытого ключа. Открытый ключ публикуется в сертификате владельца и доступен подключившемуся клиенту, а закрытый – хранится у владельца сертификата.
Открытый и закрытый ключ между собой связаны математическими зависимостями, поэтому подобрать открытый или закрытый ключ невозможно за короткое время (срок действия сертификата). 
Предположим, что у нас есть 2 абонента – A и Б.  В таком случае основная часть протокола взаимодействия пользователей при использовании ЭЦП на базе алгоритма RSA состоит из следующих шагов:
1.	Сначала пользователь А шифрует сообщение (или его хэш) своим закрытым ключом. В результате этих действий пользователь А подписывает сообщение.
2.	Затем пользователь А, шифрует то, что получилось на шаге 1 открытым ключом пользователя Б. На этом этапе сообщение шифруется, чтобы никто посторонний не мог его прочитать. 
3.	Полученная последовательность передается к пользователю Б.
4.	Пользователь Б получает последовательность и расшифровывает ее, используя свой закрытый ключ.
5.	Затем Б, используя открытый ключ пользователя А, расшифровывает оригинальное сообщение.

В результате абонент Б получает исходное сообщение и убеждается в том, что его отправил именно абонент А. Данная схема позволяет защититься от нескольких видов возможных нарушений, а именно:
- пользователь А не может отказаться от своего сообщения, если он признает, что секретный ключ известен только ему;
- нарушитель без знания секретного ключа не может ни сформировать, ни сделать осмысленное изменение сообщения, передаваемого по линии связи.

Данная схема позволяет избежать многих конфликтных ситуаций. Иногда нет необходимости зашифровывать передаваемое сообщение, но нужно его скрепить электронной подписью. В этом случае из приведенного выше протокола исключаются шаги 2 и 4, то есть текст шифруется закрытым ключом отправителя, и полученная последовательность присоединяется к документу. Получатель с помощью открытого ключа отправителя расшифровывает прикрепленную подпись, которая, по сути, является зашифрованным повторением основного сообщения. Если расшифрованная подпись совпадает с основным текстом, значит, подпись верна.

## Задание
Необходимо разработать программное решение, позволяющее выполнить следующие сценарии:

### Сценарий 1:
1.	Клиент подписывает сообщение.
2.	Клиент обращается к серверу и передает ему подписанное сообщение. 
3.	Клиент проверяет статус верификации, возвращенный ему сервером.

### Сценарий 2:
1.	Клиент запрашивает публичный ключ сервера.
2.	Клиент запрашивает генерацию случайного сообщения на сервере.
3.	Клиент осуществляет верификацию полученного сообщения.

Для ЭЦП следует использовать RSA + SHA256.
